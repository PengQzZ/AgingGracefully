import{r as h,af as R,n as J,f as S,e as Y,g as W,z as Q,k as X,a8 as ee,A as te,b as d,Z as oe,F as ne,T as ae,q as se,y as le,m as E,am as ce,an as ie,B as re,h as ue}from"./index-4aaa8925.js";import{n as z,t as T,h as L,J as de,a2 as fe,a as ve,e as P,m as b,c as H,s as K,u as me,a3 as ye,H as he,I as U,w as Ce,p as ke,a4 as Oe,l as we,X as ge}from"./index-1d524986.js";import{u as j}from"./use-expose-4d3535a4.js";import{u as be,O as Ie}from"./index-098f33cf.js";import{P as pe}from"./on-popup-reopen-bc1917c0.js";import{c as Se}from"./interceptor-e50a7bfa.js";import{L as Pe}from"./index-0401c95d.js";const xe={show:Boolean,zIndex:z,overlay:T,duration:z,teleport:[String,Object],lockScroll:T,lazyRender:T,beforeClose:Function,overlayStyle:Object,overlayClass:L,transitionAppear:Boolean,closeOnClickOverlay:T};function Te(e,t){return e>t?"horizontal":t>e?"vertical":""}function Be(){const e=h(0),t=h(0),o=h(0),l=h(0),n=h(0),a=h(0),s=h(""),u=()=>s.value==="vertical",y=()=>s.value==="horizontal",f=()=>{o.value=0,l.value=0,n.value=0,a.value=0,s.value=""};return{move:c=>{const v=c.touches[0];o.value=(v.clientX<0?0:v.clientX)-e.value,l.value=v.clientY-t.value,n.value=Math.abs(o.value),a.value=Math.abs(l.value);const C=10;(!s.value||n.value<C&&a.value<C)&&(s.value=Te(n.value,a.value))},start:c=>{f(),e.value=c.touches[0].clientX,t.value=c.touches[0].clientY},reset:f,startX:e,startY:t,deltaX:o,deltaY:l,offsetX:n,offsetY:a,direction:s,isVertical:u,isHorizontal:y}}let I=0;const _="van-overflow-hidden";function ze(e,t){const o=Be(),l="01",n="10",a=m=>{o.move(m);const i=o.deltaY.value>0?n:l,c=fe(m.target,e.value),{scrollHeight:v,offsetHeight:C,scrollTop:w}=c;let O="11";w===0?O=C>=v?"00":"01":w+C>=v&&(O="10"),O!=="11"&&o.isVertical()&&!(parseInt(O,2)&parseInt(i,2))&&ve(m,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",a,{passive:!1}),I||document.body.classList.add(_),I++},u=()=>{I&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",a),I--,I||document.body.classList.remove(_))},y=()=>t()&&s(),f=()=>t()&&u();de(y),R(f),J(f),S(t,m=>{m?s():u()})}const Ae=P({},xe,{round:Boolean,position:b("center"),closeIcon:b("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:b("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Le,M]=H("popup");var Ee=Y({name:Le,inheritAttrs:!1,props:Ae,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:l}){let n,a;const s=h(),u=h(),y=be(()=>e.show||!e.lazyRender),f=W(()=>{const r={zIndex:s.value};if(K(e.duration)){const k=e.position==="center"?"animationDuration":"transitionDuration";r[k]=`${e.duration}s`}return r}),m=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:ye(),t("open"))},i=()=>{n&&Se(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},c=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&i()},v=()=>{if(e.overlay)return d(Ie,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:c},{default:l["overlay-content"]})},C=r=>{t("clickCloseIcon",r),i()},w=()=>{if(e.closeable)return d(U,{role:"button",tabindex:0,name:e.closeIcon,class:[M("close-icon",e.closeIconPosition),he],classPrefix:e.iconPrefix,onClick:C},null)},O=()=>t("opened"),V=()=>t("closed"),G=r=>t("keydown",r),q=y(()=>{var r;const{round:k,position:x,safeAreaInsetTop:A,safeAreaInsetBottom:Z}=e;return se(d("div",E({ref:u,style:f.value,role:"dialog",tabindex:0,class:[M({round:k,[x]:x}),{"van-safe-area-top":A,"van-safe-area-bottom":Z}],onKeydown:G},o),[(r=l.default)==null?void 0:r.call(l),w()]),[[le,e.show]])}),D=()=>{const{position:r,transition:k,transitionAppear:x}=e,A=r==="center"?"van-fade":`van-popup-slide-${r}`;return d(ae,{name:k||A,appear:x,onAfterEnter:O,onAfterLeave:V},{default:q})};return S(()=>e.show,r=>{r&&!n&&(m(),o.tabindex===0&&Q(()=>{var k;(k=u.value)==null||k.focus()})),!r&&n&&(n=!1,t("close"))}),j({popupRef:u}),ze(u,()=>e.show&&e.lockScroll),me("popstate",()=>{e.closeOnPopstate&&(i(),a=!1)}),X(()=>{e.show&&m()}),ee(()=>{a&&(t("update:show",!0),a=!1)}),R(()=>{e.show&&e.teleport&&(i(),a=!0)}),te(pe,()=>e.show),()=>e.teleport?d(oe,{to:e.teleport},{default:()=>[v(),D()]}):d(ne,null,[v(),D()])}});const De=Ce(Ee);let p=0;function _e(e){e?(p||document.body.classList.add("van-toast--unclickable"),p++):p&&(p--,p||document.body.classList.remove("van-toast--unclickable"))}const[Me,g]=H("toast"),Ne=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],Re={icon:String,show:Boolean,type:b("text"),overlay:Boolean,message:z,iconSize:z,duration:Oe(2e3),position:b("middle"),teleport:[String,Object],wordBreak:String,className:L,iconPrefix:String,transition:b("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var Ye=Y({name:Me,props:Re,emits:["update:show"],setup(e,{emit:t,slots:o}){let l,n=!1;const a=()=>{const i=e.show&&e.forbidClick;n!==i&&(n=i,_e(n))},s=i=>t("update:show",i),u=()=>{e.closeOnClick&&s(!1)},y=()=>clearTimeout(l),f=()=>{const{icon:i,type:c,iconSize:v,iconPrefix:C,loadingType:w}=e;if(i||c==="success"||c==="fail")return d(U,{name:i||c,size:v,class:g("icon"),classPrefix:C},null);if(c==="loading")return d(Pe,{class:g("loading"),size:v,type:w},null)},m=()=>{const{type:i,message:c}=e;if(o.message)return d("div",{class:g("text")},[o.message()]);if(K(c)&&c!=="")return i==="html"?d("div",{key:0,class:g("text"),innerHTML:String(c)},null):d("div",{class:g("text")},[c])};return S(()=>[e.show,e.forbidClick],a),S(()=>[e.show,e.type,e.message,e.duration],()=>{y(),e.show&&e.duration>0&&(l=setTimeout(()=>{s(!1)},e.duration))}),X(a),ce(a),()=>d(De,E({class:[g([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:u,onClosed:y,"onUpdate:show":s},ke(e,Ne)),{default:()=>[f(),m()]})}});function Xe(){const e=re({show:!1}),t=n=>{e.show=n},o=n=>{P(e,n,{transitionAppear:!0}),t(!0)},l=()=>t(!1);return j({open:o,close:l,toggle:t}),{open:o,close:l,state:e,toggle:t}}function He(e){const t=ie(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const Ke={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let B=[],Ue=!1,N=P({},Ke);const je=new Map;function F(e){return ge(e)?e:{message:e}}function Fe(){const{instance:e,unmount:t}=He({setup(){const o=h(""),{open:l,state:n,close:a,toggle:s}=Xe(),u=()=>{},y=()=>d(Ye,E(n,{onClosed:u,"onUpdate:show":s}),null);return S(o,f=>{n.message=f}),ue().render=y,{open:l,close:a,message:o}}});return e}function $e(){if(!B.length||Ue){const e=Fe();B.push(e)}return B[B.length-1]}function Ve(e={}){if(!we)return{};const t=$e(),o=F(e);return t.open(P({},N,je.get(o.type||N.type),o)),t}const $=e=>t=>Ve(P({type:e},F(t))),tt=$("success"),ot=$("fail");export{De as P,Ve as a,Xe as b,ot as c,Ye as d,He as m,tt as s,Be as u};
