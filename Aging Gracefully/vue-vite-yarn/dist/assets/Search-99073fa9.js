import{a8 as A,a as R,o as u,c as y,F as B,Y as N,p as g,w as n,d,L as x,u as r,b as s,s as c,a9 as U,aa as D,K as M,ab as F,r as K,k as L,M as $,B as E,D as G,ac as H}from"./index-4aaa8925.js";import{u as z,C as I}from"./index-1468639d.js";import{B as T}from"./index-81d9fd27.js";import{A as Y,a as j,b as q}from"./index-f04f6406.js";import"./index-371a1e32.js";import"./index-ec902864.js";import{S as J}from"./index-81e91a63.js";import{s as O}from"./serviceAxios-fb88dc5b.js";import"./index-1d524986.js";import"./use-route-650222ba.js";import"./index-0401c95d.js";import"./use-expose-4d3535a4.js";import"./use-placeholder-db37aa89.js";import"./on-popup-reopen-bc1917c0.js";import"./interceptor-e50a7bfa.js";const Q={class:"searchbody"},W=c("p",null,"最近搜索",-1),X=c("br",null,null,-1),Z=c("br",null,null,-1),ee=c("p",null,"热门搜索",-1),te={__name:"searchSuggest",emits:["gotoSugResult"],setup(h,{emit:o}){const m=z();function p(){console.log("从接口获取数据，自主完成！！")}A(()=>{console.log("我是 keep-alive 存在的search suggest"),p()});function e(i){o("gotoSugResult",i)}return(i,f)=>{const v=T,t=R("nut-button");return u(),y("div",Q,[W,(u(!0),y(B,null,N(r(m).getRecentSearch,(_,a)=>(u(),g(v,{type:"default",size:"small",onClick:b=>e(_)},{default:n(()=>[d(x(_),1)]),_:2},1032,["onClick"]))),256)),X,Z,ee,s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1}),s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1}),s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1}),s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1}),s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1}),s(t,{type:"default",size:"small"},{default:n(()=>[d("默认按钮")]),_:1})])}}};const oe={class:"cardbody"},ae={style:{color:"gray"}},ne=c("br",null,null,-1),se=c("span",{style:{color:"gray"}},"其他信息",-1),le=c("br",null,null,-1),ue={__name:"searchResult",props:{data:Array},setup(h){const o=h;var{data:m}=U(o);const p=z(),{cart:e}=D(p);A(()=>{console.log("计算一次"),i()});function i(){console.log(e.value),e.value.total=0,e.value.sumPrice=0;for(var t in e.value.data)e.value.total=Number(e.value.total)+Number(e.value.data[t].num),e.value.sumPrice=Number(e.value.sumPrice)+Number(e.value.data[t].price)*Number(e.value.data[t].num);console.log(e.value.total,e.value.sumPrice)}function f(t,_){e.value.data[t]={num:1,price:_},i()}function v(t){F.push({name:"commodity_detail",params:{id:t}})}return(t,_)=>{const a=J,b=T,C=I,S=Y,V=j,w=q;return u(),y("div",null,[c("div",oe,[(u(!0),y(B,null,N(r(m),(l,P)=>(u(),g(C,{key:P,price:l.price,title:l.title,thumb:l.imgUrl,onClick:k=>v(l.id)},{desc:n(()=>[c("span",ae,x(l.delivery),1),ne,se,le]),num:n(()=>[c("div",{onClick:_[0]||(_[0]=M(()=>{},["stop"]))},[r(e).data[l.id]&&r(e).data[l.id].num?(u(),g(a,{key:0,modelValue:r(e).data[l.id].num,"onUpdate:modelValue":k=>r(e).data[l.id].num=k,theme:"round","button-size":"22",min:"0","disable-input":"",onChange:i,"default-value":"0"},null,8,["modelValue","onUpdate:modelValue"])):(u(),g(b,{key:1,round:"",size:"mini",type:"primary",onClick:k=>f(l.id,l.price)},{default:n(()=>[d("加入购物车")]),_:2},1032,["onClick"]))])]),_:2},1032,["price","title","thumb","onClick"]))),128))]),s(w,null,{default:n(()=>[s(S,{icon:"shop-o",text:"首页",to:{name:"home"}}),s(S,{icon:"cart-o",text:"购物车",to:{name:"cart"},badge:r(e).total},null,8,["badge"]),s(V,{type:"danger",to:{name:"order_submit"}},{default:n(()=>[c("span",null,x(r(e).sumPrice)+" 去支付",1)]),_:1})]),_:1})])}}},ce=h=>O({url:"/commodities",method:"get",params:h}),ke={__name:"Search",setup(h){const o=z(),m={searchResult:ue,searchSuggest:te},p=K(null);L(()=>{e(o.searchValue)});function e(a){console.log("save",o.searchValue),a?(o.saveRecentSearch(o.searchValue),v()):i()}function i(){console.log("sugg"),p.value=$(m.searchSuggest)}const f=E({data:[]});function v(){console.log("result",o.searchValue),ce({searchkey:o.searchValue}).then(a=>{console.log("res",a),a.code==0&&(f.data=a.data)}).catch(a=>{console.log(a)}),p.value=$(m.searchResult)}function t(){o.searchValue||i()}function _(a){console.log("切换组件"),o.searchValue=a,e(a)}return(a,b)=>{const C=R("nut-button"),S=R("nut-searchbar");return u(),y(B,null,[s(S,{modelValue:r(o).searchValue,"onUpdate:modelValue":b[0]||(b[0]=V=>r(o).searchValue=V),onChange:t},{rightout:n(()=>[s(C,{type:"primary",size:"small",onClick:e},{default:n(()=>[d("搜 索")]),_:1})]),_:1},8,["modelValue"]),(u(),g(H,null,[(u(),g(G(p.value),{data:f.data,onGotoSugResult:_},null,40,["data"]))],1024))],64)}}};export{ke as default};
